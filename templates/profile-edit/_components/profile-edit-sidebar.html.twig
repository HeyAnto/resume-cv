<div class="profile-edit-sidebar">

  <div class="flex flex-column">

    <a href="{{ path('app_profile', {'username': username}) }}" class="btn-menu">
      Back to Profile
    </a>

    <a href="{{ path('app_profile_edit', {'username': username}) }}"
      class="btn-menu {{ app.request.get('_route') == 'app_profile_edit' ? 'active' : '' }}">
      General
    </a>

    <a href="{{ path('app_account_edit', {'username': username}) }}"
      class="btn-menu {{ app.request.get('_route') == 'app_account_edit' ? 'active' : '' }}">
      Account
    </a>

    <a href="{{ path('app_post_list', {'username': username}) }}"
      class="btn-menu {{ app.request.get('_route') == 'app_post_list' ? 'active' : '' }}">
      Post
    </a>

    {# Get sections info first #}
    {% set workExperienceOrder = null %}
    {% set educationOrder = null %}
    {% set targetProfile = profile is defined ? profile : app.user.profile %}
    {% if targetProfile and targetProfile.resumeSections %}
    {% for section in targetProfile.resumeSections %}
    {% if section.label == 'Work Experience' %}
    {% set workExperienceOrder = section.orderIndex %}
    {% elseif section.label == 'Education' %}
    {% set educationOrder = section.orderIndex %}
    {% endif %}
    {% endfor %}
    {% endif %}

    {# Set default orders if sections don't exist #}
    {% set workExperienceOrder = workExperienceOrder ?? 1 %}
    {% set educationOrder = educationOrder ?? 2 %}

    {# Display sections in order based on orderIndex #}
    {% if workExperienceOrder <= educationOrder %} <a href="{{ path('app_experience_list', {'username': username}) }}"
      class="btn-menu {{ app.request.get('_route') in ['app_experience_list', 'app_experience_edit'] ? 'active' : '' }}">
      Work Experience
      <span class="text-12 text-color-tertiary">{{ workExperienceOrder }}</span>
      </a>

      <a href="{{ path('app_education_list', {'username': username}) }}"
        class="btn-menu {{ app.request.get('_route') in ['app_education_list', 'app_education_edit'] ? 'active' : '' }}">
        Education
        <span class="text-12 text-color-tertiary">{{ educationOrder }}</span>
      </a>
      {% else %}
      <a href="{{ path('app_education_list', {'username': username}) }}"
        class="btn-menu {{ app.request.get('_route') in ['app_education_list', 'app_education_edit'] ? 'active' : '' }}">
        Education
        <span class="text-12 text-color-tertiary">{{ educationOrder }}</span>
      </a>

      <a href="{{ path('app_experience_list', {'username': username}) }}"
        class="btn-menu {{ app.request.get('_route') in ['app_experience_list', 'app_experience_edit'] ? 'active' : '' }}">
        Work Experience
        <span class="text-12 text-color-tertiary">{{ workExperienceOrder }}</span>
      </a>
      {% endif %}

  </div>

</div>